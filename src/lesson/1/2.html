<html lang="kr">
<head>
  <title>Hello Vue</title>
  <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div id="app">
  <div class="container">
    <h1>Let's hear some stories!</h1>
    <ul class="list-group">
      <story v-for="story in stories" :story="story" :favorite="favorite" @update="updateFavorite"></story>
    </ul>
    <pre>{{ $data }}</pre>
  </div>
</div>
<template id="story-template">
  <li class="list-group-item">
    {{ story.writer }} said "{{ story.plot }}"
    <br>
    Story upvotes {{ story.upvotes }}.
    <button v-show="!story.voted" @click="upvote" class="btn btn-default">Upvote</button>
    <button v-show="!isFavorite" @click="updateFavorite" class="btn btn-primary">Favorite</button>
    <span v-show="isFavorite" class="glyphicon glyphicon-star pull-right" aria-hidden="true"></span>
  </li>
</template>
</body>
<script src="//cdnjs.cloudflare.com/ajax/libs/vue/2.3.4/vue.js"></script>
<script type="text/javascript">
  Vue.component('story', {
    template: '#story-template',
    props: ['story', 'favorite'],
    methods: {
      upvote: function () {
        this.story.upvotes++;
        this.story.voted = true;
      },
      setFavorite: function () {
        this.favorite = this.story;
      },
      updateFavorite: function() {
        this.$emit('update', this.story);
      }
    },
    computed: {
      isFavorite: function () {
        return this.story === this.favorite;
      }
    }
  });
  new Vue({
    el: '#app',
    data: {
      stories: [
        {
          plot: 'My Enemies will be die.',
          writer: 'Cronox',
          upvotes: 28,
          voted: false,
        },
        {
          plot: 'Narwhals invented Shish Kebab.',
          writer: 'Mr.Weeble',
          upvotes: 7,
          voted: false,
        },
        {
          plot: 'The dark side of the force is stronger.',
          writer: 'Darth Vader',
          upvotes: 56,
          voted: false,
        },
        {
          plot: 'One does not simply walk into Mordor.',
          writer: 'Boromir',
          upvotes: 98,
          voted: false,
        },
        {
          plot: 'May the Force be with you.',
          writer: 'Obi-Wan Kenobi',
          upvotes: 100,
          voted: false,
        }
      ],
      favorite: {},
    },
    methods: {
      updateFavorite: function(story) {
        this.favorite = story;
      }
    }
  })
</script>
</html>
